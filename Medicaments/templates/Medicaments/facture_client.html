{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="{% static 'styleFacture.css' %}">
  <title>Facture</title>

  <style>
    /* Petit bloc ticket sans casser ton style actuel */
    .infos-pharma{
      margin: 10px 0 15px 0;
      font-size: 14px;
      line-height: 1.4;
    }
    .infos-pharma .ligne{
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .muted{ opacity: .85; }
    .badge{
      display:inline-block;
      padding:2px 8px;
      border:1px solid #ccc;
      border-radius:6px;
      font-size:12px;
    }

    @media print{
      #print-button{ display:none; }
    }
  </style>
</head>

<body>
  <main>

    <!-- LOGO + IDENTITÉ -->
    <img src="{% static 'logo.png' %}" alt="logo" width="10%">
    <h1>{{ pharmacie_nom|default:"PHARMACIE" }}</h1>
    <p class="muted">{{ pharmacie_adresse|default:"Adresse" }}</p>
    <p class="muted">{{ pharmacie_ville|default:"Ville" }}</p>
    <p class="muted">Tél : (+227) 97 47 17 43 / 90 47 17 43</p>

    <!-- INFOS ADMIN -->
    <div class="infos-pharma">
      <div class="ligne">
        <span>NIF : <strong>{{ pharmacie_nif|default:"-" }}</strong></span>
        <span>RCCM : <strong>{{ pharmacie_rccm|default:"-" }}</strong></span>
      </div>
      <div class="ligne">
        <span>Vendeur(euse) : <strong>{{ vendeur|default:"-" }}</strong></span>
        <span>Caissier(ère) : <strong>{{ caissier|default:"-" }}</strong></span>
      </div>
      <div class="ligne">
        <span>Mode paiement : <strong class="badge">{{ mode_paiement|default:"Espèce" }}</strong></span>
        <span>Date & Heure : <strong>{{ sale_date|date:"d/m/Y H:i:s" }}</strong></span>
      </div>
    </div>

    <h2>Facture de vente</h2>

    <!-- CLIENT -->
    <table class="client">
      <tr>
        <th>Client</th>
        <th>N° de facture</th>
      </tr>
      <tr>
        <td>
          {% if customer.name %}
            {{ customer.name }}
          {% else %}
            {{ customer }}
          {% endif %}
        </td>
        <td>{{ id }}</td>
      </tr>
    </table>

    <hr size="1">

    <!-- DÉTAILS -->
    <table class="description">
      <tbody>
        <tr>
          <th>Désignation</th>
          <th>Qté</th>
          <th>PU</th>
          <th>Montant</th>
        </tr>
        <tr>
          <td>
            <strong>
              {% if produit.name %}{{ produit.name }}{% else %}{{ produit }}{% endif %}
            </strong>
            <br>
            <span class="muted">
              {% if produit.description %}{{ produit.description }}{% endif %}
            </span>
          </td>
          <td>{{ quantite }}</td>
          <td>{{ prix_unitaire }} FCFA</td>
          <td><strong>{{ total_amount }} FCFA</strong></td>
        </tr>
      </tbody>

      <tfoot>
        <tr>
          <td colspan="2">Remarque</td>
          <td colspan="2">Les produits vendus ne sont ni échangés ni remboursés.</td>
        </tr>
        <tr>
          <td colspan="4">Pour tout souci, voir le vendeur.</td>
        </tr>
        <tr>
          <td colspan="3"><strong>Total TTC</strong></td>
          <td><strong>{{ total_amount }} FCFA</strong></td>
        </tr>
      </tfoot>
    </table>

  </main>

  <button id="print-button" style="background-color: blue; color: aliceblue;">Imprimer</button>

  <script>
    document.getElementById("print-button").addEventListener("click", function() {
      window.print();
    });
  </script>
</body>
</html>
